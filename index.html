<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—˜ë¦¬í•˜ì´ ë¬¸í•´ë ¥ ì§„ë‹¨ ê²€ì‚¬</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           1. ì„¤ì • ë° ë³€ìˆ˜ (Variables & Reset)
           ========================================= */
        :root {
            /* Main Colors */
            --primary-blue: #1e7df0;
            --sky-blue: #00b0ff;
            --text-dark: #333;
            --text-gray: #666;
            --bg-gray: #f2f2f2;
            --title-bg: #e9ecef;
            
            /* Chart Colors */
            --col-vocab: #1e7df0; 
            --col-fact: #00c896;  
            --col-crit: #ffb300;  
            --col-inf: #ff5252;   
            
            /* Pastel Banner Colors */
            --b-green: #a5d6a7; --b-yellow: #fff59d; --b-orange: #ffcc80;
            --b-blue: #90caf9; --b-purple: #ce93d8; --b-teal: #80cbc4;
            --b-brown: #bcaaa4; --b-lime: #e6ee9c; --b-sky: #81d4fa; --b-gold: #ffe082;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Noto Sans KR', sans-serif; }
        body { background-color: var(--bg-gray); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        button, select { border: none; background: none; cursor: pointer; font-family: inherit; outline: none; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }

        /* =========================================
           2. ë ˆì´ì•„ì›ƒ (Layout)
           ========================================= */
        .app-container { 
            width: 1200px; height: 800px; 
            background: white; border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
            overflow: hidden; position: relative; 
            display: flex; flex-direction: column;
        }

        /* Common Utilities */
        .highlight-blue { color: var(--sky-blue); font-weight: 700; }
        .section-title-pill { 
            display: flex; justify-content: space-between; align-items: center; 
            background-color: var(--title-bg); color: var(--text-dark); 
            padding: 10px 20px; border-radius: 30px; 
            font-size: 16px; font-weight: 700; margin-bottom: 20px; width: 100%; 
        }

        /* =========================================
           3. GNB (Global Navigation Bar)
           ========================================= */
        .gnb { 
            background-color: #2b2b2b; height: 64px; 
            display: flex; align-items: center; padding: 0 30px; 
            color: #aaa; font-size: 15px; font-weight: 500; flex-shrink: 0;
        }
        .gnb-logo { font-weight: 900; font-size: 26px; margin-right: 40px; letter-spacing: -1px; cursor: pointer; }
        .logo-eli { color: #ff9800; } .logo-high { color: #00b0ff; }
        .gnb-menu { display: flex; gap: 12px; flex: 1; height: 100%; } 
        .gnb-item { 
            cursor: pointer; height: 100%; display: flex; align-items: center; 
            padding: 0 12px; 
            border-bottom: 4px solid transparent; transition: all 0.2s;
            white-space: nowrap; 
        }
        .gnb-item.active { color: white; font-weight: 800; border-bottom: 4px solid white; }
        .gnb-item:hover { color: #fff; }

        /* =========================================
           4. ë©”ì¸ í™”ë©´ (New Dashboard Layout)
           ========================================= */
        #main-screen { flex: 1; background-color: #f5f6f8; padding: 20px; overflow-y: auto; }
        .dashboard-grid { display: grid; grid-template-columns: 200px 1fr 320px; gap: 20px; height: 540px; }

        /* --- Left Column --- */
        .left-sidebar { display: flex; flex-direction: column; gap: 20px; height: 100%; }
        .subject-menu-box { 
            background: #e0f2f1; border-radius: 12px; overflow: hidden; border: 1px solid #b2dfdb; height: 400px; 
            display: flex; flex-direction: column; 
        }
        .subject-header { padding: 15px; font-weight: 800; font-size: 16px; color: #00695c; border-bottom: 1px solid #b2dfdb; display: flex; justify-content: space-between; align-items: center; }
        .subject-list { display: flex; flex-direction: column; flex: 1; }
        .subject-item { padding: 15px 20px; font-weight: 700; color: #004d40; cursor: pointer; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid rgba(0,0,0,0.05); transition: background 0.2s; flex: 1; }
        .subject-item:hover { background: #b2dfdb; }
        .subject-item:last-child { border-bottom: none; }
        .subject-icon { font-size: 18px; width: 24px; text-align: center; }

        .story-banner { 
            background: #80deea; border-radius: 12px; padding: 20px; color: #006064; 
            text-align: center; font-weight: 700; cursor: pointer; 
            box-shadow: 0 4px 10px rgba(0,188,212,0.1); height: 120px; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
        }
        .story-title { font-size: 20px; margin-bottom: 5px; line-height: 1.3; }
        .story-sub { font-size: 13px; opacity: 0.8; }

        /* --- Center Column --- */
        .center-feed { display: flex; flex-direction: column; gap: 20px; height: 100%; }
        .hero-banner { 
            background: #fff3e0; border-radius: 15px; height: 240px; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            text-align: center; border: 1px solid #ffe0b2; position: relative; overflow: hidden; flex-shrink: 0; 
        }
        .hero-bg-pattern { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: radial-gradient(#ffcc80 1px, transparent 1px); background-size: 20px 20px; opacity: 0.2; }
        .hero-content { position: relative; z-index: 1; }
        .hero-tag { background: #ffcc80; color: #5d4037; padding: 5px 15px; border-radius: 20px; font-weight: 700; font-size: 14px; margin-bottom: 15px; display: inline-block; }
        .hero-main-title { font-size: 32px; font-weight: 900; color: #3e2723; margin-bottom: 10px; line-height: 1.2; }
        .hero-sub-title { font-size: 18px; color: #5d4037; font-weight: 600; }

        .diagnostic-trigger-banner { 
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 3px dashed #1e7df0; 
            border-radius: 15px; height: 140px; display: flex; align-items: center; justify-content: space-between; 
            padding: 0 40px; cursor: pointer; position: relative; animation: pulse 2s infinite ease-in-out; 
            box-shadow: 0 8px 20px rgba(30,125,240,0.15); transition: transform 0.2s; flex-shrink: 0; 
        }
        .diagnostic-trigger-banner:hover { transform: scale(1.02); }
        @keyframes pulse { 
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(30, 125, 240, 0.4); } 
            50% { transform: scale(1.02); box-shadow: 0 0 0 10px rgba(30, 125, 240, 0); } 
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(30, 125, 240, 0); } 
        }
        .diag-text-group { text-align: left; }
        .diag-sub { font-size: 16px; color: #1565c0; font-weight: 700; margin-bottom: 5px; }
        .diag-title { font-size: 26px; font-weight: 900; color: #0d47a1; letter-spacing: -0.5px; }
        
        .diag-icon-wrapper { 
            position: relative; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            transform: translateY(-8px); 
        }
        .diag-icon { font-size: 50px; line-height: 1; }
        
        .diag-badge { 
            background: #ff5252; color: white; font-weight: 800; 
            padding: 5px 12px; border-radius: 20px; font-size: 13px; 
            position: relative; 
            margin-bottom: 8px; 
            white-space: nowrap; 
            box-shadow: 0 3px 6px rgba(255, 82, 82, 0.3);
            z-index: 10;
        }
        
        .diag-badge::after { 
            content: ''; 
            position: absolute; 
            bottom: -5px; 
            left: 50%; 
            transform: translateX(-50%);
            border-width: 6px 6px 0; 
            border-style: solid; 
            border-color: #ff5252 transparent; 
            display: block; 
            width: 0; 
        }

        .bottom-banner-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 120px; flex-shrink: 0; }
        .sub-banner { 
            height: 100%; border-radius: 12px; overflow: hidden; position: relative; 
            display: flex; flex-direction: column; justify-content: center; padding: 20px; 
            color: #333; font-weight: 700; cursor: pointer; transition: transform 0.2s; 
        }
        .sub-banner:hover { transform: translateY(-3px); }
        .sb-1 { background: linear-gradient(to right, #e1bee7, #ce93d8); color: #4a148c; }
        .sb-2 { background: linear-gradient(to right, #fff9c4, #fff59d); color: #f57f17; }
        .sb-title { font-size: 18px; margin-bottom: 5px; z-index: 1; }
        .sb-desc { font-size: 13px; font-weight: 400; opacity: 0.9; z-index: 1; }
        .sb-img { position: absolute; right: 10px; bottom: 10px; font-size: 40px; opacity: 0.5; }

        /* --- Right Column --- */
        .right-sidebar { display: flex; flex-direction: column; height: 100%; gap: 20px; }
        .plus-box { background: white; border-radius: 12px; padding: 20px; border: 1px solid #eee; flex-shrink: 0; }
        .widget-title { font-size: 16px; font-weight: 800; color: #333; margin-bottom: 15px; display: flex; align-items: center; gap: 5px; }
        .plus-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .plus-item { background: #f5f5f5; border-radius: 8px; padding: 10px; font-size: 13px; font-weight: 600; color: #555; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .plus-item:hover { background: #eee; }
        .pi-icon { width: 24px; height: 24px; background: #fff; border-radius: 5px; display: flex; justify-content: center; align-items: center; font-size: 12px; border: 1px solid #ddd; }

        .app-grid { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(3, 1fr); gap: 10px; flex-grow: 1; }
        .app-card { 
            height: 100%; border-radius: 10px; padding: 10px; color: #333; font-weight: 700; font-size: 15px; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; 
            cursor: pointer; transition: transform 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.05); line-height: 1.3; 
        }
        .app-card:hover { transform: scale(1.05); z-index: 2; }
        
        /* Helper Classes for Colors */
        .bg-lime { background: var(--b-lime); color: #558b2f; } .bg-purple { background: var(--b-purple); color: #6a1b9a; }
        .bg-sky { background: var(--b-sky); color: #0277bd; } .bg-brown { background: var(--b-brown); color: #4e342e; }
        .bg-teal { background: var(--b-teal); color: #00695c; } .bg-gold { background: var(--b-gold); color: #ff6f00; }

        /* =========================================
           5. í€´ì¦ˆ / ê²°ê³¼ / ë¡œë”© í™”ë©´
           ========================================= */
        #quiz-screen, #loading-screen, #result-screen { display: none; height: 100%; }
        
        #quiz-screen { padding: 40px; flex-direction: column; }
        .quiz-top-bar { display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .quiz-area-indicator { padding: 8px 20px; border-radius: 30px; font-size: 16px; font-weight: 700; color: #aaa; background-color: #eee; transition: all 0.3s; }
        .quiz-area-indicator.active { background-color: var(--primary-blue); color: white; box-shadow: 0 4px 10px rgba(30,125,240,0.3); }

        .question-step { display: none; flex: 1; flex-direction: column; justify-content: center; animation: fadeIn 0.5s; }
        .question-step.active { display: flex; }
        .question-title { font-size: 22px; font-weight: 700; margin-bottom: 30px; color: var(--text-dark); display: flex; align-items: center; }
        .q-number-badge { background: #ff5252; color: white; width: 28px; height: 28px; border-radius: 50%; display: inline-flex; justify-content: center; align-items: center; font-weight: bold; font-size: 16px; margin-right: 10px; }
        
        .example-box { border: 2px solid #eee; border-radius: 15px; padding: 40px; text-align: center; margin-bottom: 50px; background: #fafafa; position: relative; }
        .example-box::before { content: "<ë³´ê¸°>"; position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: white; padding: 0 10px; color: var(--text-gray); font-size: 14px; }
        .example-text { font-size: 20px; line-height: 1.8; color: #444; }
        
        .answer-row { display: flex; justify-content: center; gap: 20px; }
        .answer-btn { width: 160px; height: 64px; border: 1px solid #ddd; border-radius: 32px; background: white; font-size: 18px; font-weight: 700; color: #555; transition: all 0.2s; }
        .answer-btn:hover { border-color: var(--primary-blue); color: var(--primary-blue); transform: translateY(-2px); box-shadow: 0 4px 10px rgba(30,125,240,0.1); }
        .answer-btn.selected { background-color: var(--primary-blue); color: white; border-color: var(--primary-blue); }

        .split-layout { display: flex; gap: 40px; height: 450px; }
        .passage-area { flex: 1; border: 1px solid #ddd; padding: 25px; border-radius: 12px; overflow-y: auto; background: #fdfdfd; font-size: 16px; line-height: 1.8; color: #333; }
        .question-area { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .choice-list { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
        .choice-btn { width: 100%; padding: 18px; border: 1px solid #ddd; border-radius: 12px; background: white; text-align: left; font-size: 16px; transition: 0.2s; }
        .choice-btn:hover { background: #f0f8ff; border-color: var(--primary-blue); }
        .choice-btn.selected { background: var(--primary-blue); color: white; border-color: var(--primary-blue); }

        .quiz-footer { margin-top: auto; display: flex; justify-content: center; align-items: center; position: relative; height: 60px; border-top: 1px solid #f5f5f5; }
        .progress-text { font-weight: bold; color: var(--text-gray); }
        .next-btn-area { position: absolute; right: 0; top: 50%; transform: translateY(-50%); }
        .next-arrow { width: 50px; height: 50px; background: #444; color: white; border-radius: 12px; font-size: 20px; transition: 0.2s; }
        .next-arrow:hover { background: var(--primary-blue); }

        #loading-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.95); z-index: 100; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .spinner { width: 60px; height: 60px; border: 6px solid #f3f3f3; border-top: 6px solid var(--primary-blue); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        .loading-text { font-size: 18px; font-weight: 700; color: var(--text-dark); }
        .loading-sub { font-size: 18px; color: var(--text-gray); margin-top: 5px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ê²°ê³¼ ë¦¬í¬íŠ¸ CSS */
        #result-screen { padding: 30px; overflow-y: auto; padding-bottom: 50px; animation: slideUp 0.8s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .header-res { display: flex; justify-content: center; align-items: center; margin-bottom: 30px; background-color: var(--title-bg); padding: 15px; border-radius: 12px; position: relative; }
        .header-res h1 { font-size: 24px; color: var(--text-dark); margin: 0; }
        .header-res h1 span { color: var(--primary-blue); }
        .close-btn { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); width: 32px; height: 32px; background-color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 2px 6px rgba(0,0,0,0.1); color: #666; cursor: pointer; }

        .info-bar { display: flex; gap: 40px; margin-bottom: 30px; align-items: center; position: relative; }
        .info-item { display: flex; align-items: center; gap: 5px; white-space: nowrap; position: relative; }
        .info-item.right-end { margin-left: auto; justify-content: flex-end; }
        .info-badge { background-color: var(--primary-blue); color: white; padding: 6px 12px; border-radius: 20px; font-weight: 700; font-size: 14px; }
        .info-text { font-size: 16px; font-weight: 500; color: #333; }
        
        .level-guide-btn { background-color: #bbb; color: white; padding: 4px 25px 4px 10px; border-radius: 4px; font-size: 11px; margin-left: 2px; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='16' height='16' fill='white'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 5px center; }
        .q-mark-icon { display: inline-flex; width: 16px; height: 16px; background: rgba(255,255,255,0.3); border-radius: 50%; align-items: center; justify-content: center; font-size: 11px; margin-left: 5px; cursor: help; }
        .dropdown-select { padding: 8px 25px 8px 10px; width: 125px; border: 1px solid #ddd; border-radius: 20px; font-size: 13px; color: #555; background-color: white; cursor: pointer; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='16' height='16' fill='%23555'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 8px center; }

        /* ê³µí†µ íˆ´íŒ ë° íŒì—… ìŠ¤íƒ€ì¼ */
        .klq-tooltip { visibility: hidden; width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 6px; padding: 10px; position: absolute; z-index: 100; top: 130%; left: 50%; transform: translateX(-50%); font-size: 12px; line-height: 1.5; box-shadow: 0 4px 10px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.3s; }
        .klq-tooltip::after { content: ""; position: absolute; bottom: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: transparent transparent #333 transparent; }
        .klq-tooltip.show { visibility: visible; opacity: 1; }
        
        .level-dropdown { display: none; position: absolute; top: calc(100% + 5px); right: 0; width: 140px; background: white; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); z-index: 100; flex-direction: column; overflow: hidden; left: auto; }
        .level-dropdown.show { display: flex; animation: fadeIn 0.3s; }
        .level-item { padding: 10px; font-size: 13px; color: #555; text-align: center; border-bottom: 1px solid #eee; }
        .level-item:last-child { border-bottom: none; }
        .level-item.active { background-color: #e3f2fd; color: var(--primary-blue); font-weight: bold; }

        .tooltip-text { visibility: hidden; width: 200px; background-color: rgba(30, 30, 30, 0.95); color: #fff; text-align: center; border-radius: 8px; padding: 10px; position: absolute; z-index: 10000; bottom: 15px; left: 50%; transform: translateX(-50%); opacity: 0; transition: opacity 0.3s; font-size: 12px; line-height: 1.5; box-shadow: 0 4px 15px rgba(0,0,0,0.2); word-break: keep-all; }
        .tooltip-text::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -6px; border-width: 6px; border-style: solid; border-color: rgba(30, 30, 30, 0.95) transparent transparent transparent; }
        .tooltip-text.show { visibility: visible; opacity: 1; }

        /* [ìˆ˜ì •ë¨] Grid ë¹„ìœ¨ì„ í•˜ë‹¨ê³¼ ë™ì¼í•˜ê²Œ 1.9fr : 1.1fr ë¡œ ë³€ê²½í•˜ì—¬ ë¼ì¸ ë§ì¶¤ */
        .top-summary-container { display: grid; grid-template-columns: 1.9fr 1.1fr; gap: 30px; margin-bottom: 40px; }
        
        /* [ìˆ˜ì •] ì¢Œì¸¡ ê°„ê²© 40px -> 5px -> 20pxë¡œ ë³€ê²½ */
        .summary-left { display: flex; gap: 20px; background: #f8f9fb; padding: 25px; border-radius: 15px; align-items: center; }
        .summary-right { background: white; border: 1px solid #eee; border-radius: 15px; padding: 25px; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 25px; }
        
        .donut-chart-wrap { text-align: center; margin-left: 5px; }
        .donut-chart-svg { width: 180px; height: 180px; transform: rotate(-90deg); }
        .donut-bg-ring { fill: none; stroke: #eee; stroke-width: 25; } 
        .donut-prog-ring { fill: none; stroke: var(--primary-blue); stroke-width: 25; stroke-linecap: round; 
            stroke-dasharray: 471; stroke-dashoffset: 471; transition: stroke-dashoffset 0.8s ease-out; } 
        .donut-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 32px; font-weight: bold; color: var(--primary-blue); }
        .donut-label { font-size: 13px; color: #666; margin-top: 10px; font-weight: 500; }
        
        .gauge-chart-container { width: 100%; display: flex; flex-direction: column; align-items: center; }
        .gauge-legend { display: flex; gap: 15px; font-size: 12px; color: #666; margin-bottom: 45px; align-self: flex-end; }
        .legend-dot { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 5px; }
        .legend-dot.my { background-color: var(--primary-blue); } .legend-dot.avg { background-color: #cce5ff; }
        .gauge-chart-wrap { width: 220px; height: 110px; position: relative; margin-bottom: 15px; }
        .gauge-svg { width: 100%; height: 100%; overflow: visible; }
        .gauge-bg-arc { fill: none; stroke: #f0f3f9; stroke-width: 24; stroke-linecap: round; }
        .gauge-my-arc { fill: none; stroke: var(--primary-blue); stroke-width: 24; stroke-linecap: round; stroke-dasharray: 251.3; stroke-dashoffset: 251.3; }
        .gauge-character { position: absolute; width: 32px; height: 32px; background-color: #00c896; border: 3px solid white; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); left: 20px; top: 100px; transform: translate(-50%, -50%); z-index: 2; }
        .gauge-avg-label { position: absolute; background: #cce5ff; color: var(--primary-blue); font-size: 11px; font-weight: bold; padding: 5px 10px; border-radius: 20px; left: 100px; top: 20px; transform: translate(-50%, -100%); white-space: nowrap; z-index: 1; }
        .gauge-avg-label::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #cce5ff transparent transparent transparent; }
        .gauge-bottom-text { text-align: center; }
        .gauge-sub-label { font-size: 14px; color: #888; margin-bottom: 5px; }
        .gauge-main-label { font-size: 22px; font-weight: bold; color: #333; }
        .gauge-main-label .highlight-blue { font-size: 28px; }
        
        .summary-text-wrap { width: 100%; flex: 1; }
        .summary-title { font-size: 16px; margin-bottom: 15px; line-height: 1.6; color: var(--text-dark); text-align: center; word-break: keep-all; }
        .summary-desc { font-size: 14px; line-height: 1.6; color: #555; background: white; padding: 15px; border-radius: 10px; white-space: nowrap; }

        .bottom-details-grid { display: grid; grid-template-columns: 1.9fr 1.1fr; gap: 30px; margin-bottom: 100px; }
        .graph-header { display: flex; flex-direction: column; align-items: flex-start; margin-bottom: 20px; }
        .avg-legend { font-size: 12px; color: #666; font-weight: normal; display: flex; align-items: center; gap: 6px; background: none; padding: 0; align-self: flex-end; margin-top: 5px; }
        .avg-icon-visual { width: 24px; height: 0; border-top: 3px dotted #aaccff; position: relative; display: inline-block; }
        .avg-icon-visual::after { content: ""; position: absolute; top: -5px; left: 50%; transform: translateX(-50%); width: 6px; height: 6px; background: white; border: 2px solid #aaccff; border-radius: 50%; }
        .graph-container { display: flex; justify-content: space-around; align-items: flex-end; height: 200px; border-bottom: 1px solid #ddd; position: relative; padding-left: 30px; flex: 2; }
        .y-axis-grid { position: absolute; left: 30px; right: 0; bottom: 0; top: 0; pointer-events: none; z-index: 0; }
        .grid-line { position: absolute; left: 0; right: 0; border-top: 1px solid #f0f0f0; }
        .grid-label { position: absolute; left: -30px; width: 25px; text-align: right; font-size: 11px; color: #999; transform: translateY(-50%); }
        .bar-group { display: flex; flex-direction: column; align-items: center; width: 80px; position: relative; justify-content: flex-end; height: 100%; }
        .bar { width: 36px; border-radius: 6px 6px 0 0; position: relative; height: 0px; transition: height 0.5s ease-out; z-index: 1; }
        .bar.color-1 { background-color: var(--col-vocab); } .bar.color-2 { background-color: var(--col-fact); } 
        .bar.color-3 { background-color: var(--col-crit); } .bar.color-4 { background-color: var(--col-inf); }
        .bar-value { font-size: 13px; margin-bottom: 8px; font-weight: bold; opacity: 0; transition: opacity 1s 1s; color: var(--text-dark); position: relative; z-index: 5; text-shadow: 0 0 4px rgba(255,255,255,0.8), 0 0 2px #fff; }
        .bar-group.animate .bar-value { opacity: 1; }
        .bar-label { position: absolute; bottom: -55px; font-size: 12px; width: auto; min-width: 70px; white-space: nowrap; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 5px; color: #333; font-weight: 500; }
        .label-content { display: flex; align-items: center; gap: 3px; }
        .label-icon { width: 8px; height: 8px; display: inline-block; border-radius: 2px; flex-shrink: 0; }
        .label-icon.c1 { background-color: var(--col-vocab); } .label-icon.c2 { background-color: var(--col-fact); } 
        .label-icon.c3 { background-color: var(--col-crit); } .label-icon.c4 { background-color: var(--col-inf); } 
        .graph-help-btn { display: inline-flex; width: 14px; height: 14px; background-color: #ddd; color: white; border-radius: 50%; justify-content: center; align-items: center; font-size: 10px; cursor: pointer; flex-shrink: 0; }
        .graph-help-btn:hover { background-color: #bbb; }
        .svg-graph-layer { position: absolute; top: 0; left: 30px; right: 0; width: calc(100% - 30px); height: 100%; pointer-events: none; z-index: 2; }
        .avg-line { fill: none; stroke: #aaccff; stroke-width: 3px; stroke-dasharray: 6, 4; transition: all 1s ease; }
        .avg-dot { fill: #fff; stroke: #aaccff; stroke-width: 3px; r: 6; transition: cy 1s ease; }
        .tooltip-container { position: relative; display: flex; justify-content: center; }

        .insight-container { display: flex; flex-direction: column; gap: 15px; justify-content: flex-start; height: 100%; }
        .insight-wrapper { display: flex; flex-direction: column; gap: 15px; margin-top: 0; height: 100%; }
        .insight-box { border: 1px solid #ddd; padding: 15px 20px; border-radius: 12px; text-align: center; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); height: 100%; display: flex; flex-direction: column; justify-content: center; }
        .insight-label { font-size: 14px; color: #888; margin-bottom: 5px; } 
        .insight-value { font-size: 18px; font-weight: bold; }

        .guide-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 40px; }
        .guide-card { background: #fff; border: 1px solid #eee; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .guide-header { padding: 12px; text-align: center; font-weight: 700; color: #333; font-size: 15px; }
        .level-tag { font-size: 0.9em; font-weight: normal; margin-left: 3px; }
        .guide-body { padding: 15px; font-size: 13px; line-height: 1.6; color: #555; background-color: #fcfcfc; flex: 1; word-break: keep-all; }
        .guide-card.c1 .guide-header { background-color: rgba(30, 125, 240, 0.15); color: var(--col-vocab); } 
        .guide-card.c2 .guide-header { background-color: rgba(0, 200, 150, 0.15); color: var(--col-fact); } 
        .guide-card.c3 .guide-header { background-color: rgba(255, 179, 0, 0.15); color: var(--col-crit); } 
        .guide-card.c4 .guide-header { background-color: rgba(255, 82, 82, 0.15); color: var(--col-inf); }

        .rec-container { display: flex; align-items: stretch; gap: 10px; background: #fff9f0; padding: 20px; border-radius: 15px; border: 2px dashed #ffb300; }
        .rec-group { flex: 1; background: white; border-radius: 12px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; }
        .rec-title { font-size: 16px; font-weight: 700; margin-bottom: 15px; background: #ffe0b2; width: 100%; text-align: center; padding: 8px; border-radius: 6px; color: #5d4037; }
        .plus-icon { display: flex; align-items: center; justify-content: center; font-size: 30px; color: #ccc; font-weight: bold; width: 30px; }
        .program-box { border: 2px solid #ddd; border-radius: 12px; padding: 20px; text-align: center; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; background: white; transition: all 0.3s; }
        .program-box.advanced { border-color: #7c4dff; background: linear-gradient(135deg, #f8f0ff 0%, #e8eaf6 100%); box-shadow: 0 4px 10px rgba(124, 77, 255, 0.1); }
        .program-box.advanced .program-badge { color: #6200ea; font-weight: 700; background: #d1c4e9; padding: 4px 8px; border-radius: 4px; display: inline-block; }
        .program-box.advanced .program-name { color: #311b92; font-size: 19px; }
        .program-box.basic { border-color: #ff9800; background: linear-gradient(135deg, #fff8e1 0%, #fff3e0 100%); box-shadow: 0 4px 10px rgba(255, 152, 0, 0.1); }
        .program-box.basic .program-badge { color: #e65100; font-weight: 700; background: #ffe0b2; padding: 4px 8px; border-radius: 4px; display: inline-block; }
        .program-box.basic .program-name { color: #bf360c; font-size: 19px; }
        .program-badge { font-size: 12px; margin-bottom: 10px; }
        .program-name { font-size: 18px; font-weight: bold; color: var(--text-dark); margin-bottom: 5px; }
        .book-list { display: flex; gap: 10px; overflow-x: auto; width: 100%; padding-bottom: 5px; justify-content: center; }
        .book-item { flex: 0 0 100px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .book-cover { width: 80px; height: 110px; border-radius: 2px 6px 6px 2px; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; color: white; text-align: center; padding: 5px; position: relative; box-shadow: 3px 3px 8px rgba(0,0,0,0.2); transition: transform 0.2s; }
        .book-cover::before { content: ""; position: absolute; left: 4px; top: 0; bottom: 0; width: 2px; background: rgba(255,255,255,0.2); }
        .book-cover:hover { transform: translateY(-2px); }
        .book-color-1 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .book-color-2 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .book-color-3 { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); }
        .book-color-4 { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); }
        .book-emoji { font-size: 24px; display: block; margin-bottom: 5px; }
        .book-title-on-cover { font-size: 13px; line-height: 1.3; font-weight: 800; }
        .book-title { font-size: 12px; text-align: center; line-height: 1.3; margin-top: 5px; }
        .btn-list { width: 100%; display: flex; flex-direction: column; gap: 8px; }
        .rec-btn { width: 100%; padding: 10px; background: white; border: 1px solid #1e7df0; color: #1e7df0; font-weight: 700; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .rec-btn:hover { background: #1e7df0; color: white; }
        .rec-btn.black { border-color: #333; color: #333; }
        .rec-btn.black:hover { background: #333; color: white; }
    </style>
</head>
<body>

<div class="app-container">
    <!-- GNB -->
    <div class="gnb">
        <div class="gnb-logo"><span class="logo-eli">eli</span><span class="logo-high">high</span></div>
        <div class="gnb-menu">
            <div class="gnb-item">ì „ì²´</div>
            <div class="gnb-item">ë‚˜ì˜í•™ìŠµë°©</div>
            <div class="gnb-item active">í•™êµê³µë¶€</div>
            <div class="gnb-item">ìˆ˜í•™ì •ë³µ</div>
            <div class="gnb-item">ì˜ì–´ì™„ì„±</div>
            <div class="gnb-item">íŠ¹ëª©Â·ê²½ì‹œ</div>
            <div class="gnb-item">í‰ê°€ì„¼í„°</div>
            <div class="gnb-item">ìˆ˜í–‰í‰ê°€+</div>
            <div class="gnb-item">ê¸€ë¡œë²Œë¦¬ë”ì‹­</div>
        </div>
    </div>

    <!-- ë©”ì¸ í™”ë©´ (New Dashboard) -->
    <div id="main-screen">
        <div class="dashboard-grid">
            
            <!-- Left Column: ê³¼ëª© ë©”ë‰´ -->
            <div class="left-sidebar">
                <div class="subject-menu-box">
                    <div class="subject-header">
                        ğŸ¯ í•™êµê³µë¶€
                        <span style="font-size:12px; color:#888; font-weight:400;">ì´ˆ4 âˆ¨</span>
                    </div>
                    <div class="subject-list">
                        <div class="subject-item"><span class="subject-icon">ğŸ“š</span> êµ­ì–´</div>
                        <div class="subject-item"><span class="subject-icon">â—</span> ìˆ˜í•™</div>
                        <div class="subject-item"><span class="subject-icon">ğŸ›ï¸</span> ì‚¬íšŒ</div>
                        <div class="subject-item"><span class="subject-icon">ğŸ§ª</span> ê³¼í•™</div>
                        <div class="subject-item"><span class="subject-icon">ğŸ”¤</span> ì˜ì–´</div>
                    </div>
                </div>
                <div class="story-banner">
                    <div class="story-title">ì˜¤ëŠ˜ë„<br>ì¶œê·¼í–ˆì–´ìš”!</div>
                    <div class="story-sub">ì½˜í…ì¸  ì œì‘ ìŠ¤í† ë¦¬ âœ‰ï¸</div>
                </div>
            </div>

            <!-- Center Column: ë©”ì¸ í”¼ë“œ -->
            <div class="center-feed">
                <!-- Top: Hero Banner -->
                <div class="hero-banner">
                    <div class="hero-bg-pattern"></div>
                    <div class="hero-content">
                        <div class="hero-tag">ë‹¨ë‹¨í•˜ê²Œ ë¬¸í•´ë ¥ ë‹¤ì§€ê¸°</div>
                        <div class="hero-main-title">ì—˜ë¦¬í•˜ì´<br>ë¬¸í•´ë ¥ í–¥ìƒ í”„ë¡œì íŠ¸</div>
                        <div class="hero-sub-title">ëª¨ë“  í•™ìŠµì˜ ë°‘ë°”íƒ•ì€ ë¬¸í•´ë ¥!</div>
                    </div>
                </div>

                <!-- Middle: Diagnostic Trigger -->
                <div class="diagnostic-trigger-banner" onclick="startDiagnosticTest()">
                    <div class="diag-text-group">
                        <div class="diag-sub">ì´ˆë“± ë¬¸í•´ë ¥, ì •í™•í•œ ì§„ë‹¨ìœ¼ë¡œ ì œëŒ€ë¡œ í‚¤ìš°ê¸°</div>
                        <div class="diag-title">ì—˜ë¦¬í•˜ì´ <br> ë¬¸í•´ë ¥ M-KLT ì§„ë‹¨ ê²€ì‚¬</div>
                    </div>
                    <div class="diag-icon-wrapper">
                        <div class="diag-badge">Click!</div>
                        <div class="diag-icon">ğŸ“</div>
                    </div>
                </div>

                <!-- Bottom: Sub Banners -->
                <div class="bottom-banner-row">
                    <div class="sub-banner sb-1">
                        <div class="sb-title">ì˜ì–´ ì•ŒìŒ¤ì˜<br>ì›ë”ëœë“œ</div>
                        <div class="sb-desc">ë³´ë¬¼ì´ ê°€ë“í•œ ì˜ì–´ ëª¨í—˜!</div>
                        <div class="sb-img">ğŸ°</div>
                    </div>
                    <div class="sub-banner sb-2">
                        <div class="sb-title">ëª…ë‘ ëª¨ë“œ<br>ON</div>
                        <div class="sb-desc">ì¬ë¯¸ìˆëŠ” í•™êµìƒí™œ íŒ</div>
                        <div class="sb-img">ğŸ˜„</div>
                    </div>
                </div>
            </div>

            <!-- Right Column: ìœ„ì ¯ & ì•± ë°°ë„ˆ -->
            <div class="right-sidebar">
                <!-- ìœ„ì ¯ ì„¹ì…˜ -->
                <div class="plus-box">
                    <div class="widget-title">ğŸ”” í•™êµê³µë¶€ PLUS+</div>
                    <div class="plus-grid">
                        <div class="plus-item"><span class="pi-icon">ğŸ‡¨ğŸ‡³</span> HSK</div>
                        <div class="plus-item"><span class="pi-icon">ğŸ“œ</span> í•œêµ­ì‚¬</div>
                        <div class="plus-item"><span class="pi-icon">ğŸ‰</span> í•œìì‹œí—˜</div>
                        <div class="plus-item"><span class="pi-icon">ğŸ“º</span> êµê³¼íŠ¹ê°•</div>
                        <div class="plus-item"><span class="pi-icon">ğŸ«</span> í•™êµìƒí™œ</div>
                        <div class="plus-item"><span class="pi-icon">â›‘ï¸</span> ì•ˆì „ìƒí™œ</div>
                    </div>
                </div>

                <!-- ì»¬ëŸ¬í’€ ì•± ë°°ë„ˆ ê·¸ë¦¬ë“œ -->
                <div class="app-grid">
                    <div class="app-card bg-lime">ë„ì „!<br>ì–´íœ˜ì™•</div>
                    <div class="app-card bg-purple">ë˜ë°•ë˜ë°•<br>í•œê¸€ì“°ê¸°</div>
                    <div class="app-card bg-sky">ì—˜ë¦¬ëª¬<br>ê°€ë‚˜ë‹¤</div>
                    <div class="app-card bg-brown">NEW<br>ì—˜ë¦¬ ë°›ì•„ì“°ê¸°</div>
                    <div class="app-card bg-teal">ë„ì „!<br>í•œìì™•</div>
                    <div class="app-card bg-gold">ì¹ êµ<br>ë°©íƒˆì¶œ</div>
                </div>
            </div>

        </div>
    </div>

    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading-screen"><div class="spinner"></div><div class="loading-text">ê²°ê³¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</div><div class="loading-sub">AIê°€ <strong>[ê¹€ì—˜ë¦¬]ë‹˜</strong>ì˜ ë‹µì•ˆì„ ì±„ì í•˜ê³  ìˆì–´ìš”.</div></div>

    <!-- í€´ì¦ˆ í™”ë©´ -->
    <div id="quiz-screen">
        <div class="quiz-top-bar">
            <div class="quiz-area-indicator active" id="badge-vocab">ì–´íœ˜ë ¥</div>
            <div class="quiz-area-indicator" id="badge-reading">ì§€ë¬¸ ë…í•´</div>
        </div>
        <div class="question-step active" id="q1">
            <div class="question-title"><span class="q-number-badge">1</span>&lt;ë³´ê¸°&gt;ì˜ ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ì•Œë§ì€ ë§ì€ ë¬´ì—‡ì¸ê°€ìš”?</div>
            <div class="example-box"><div class="example-text">ì¹œêµ¬ì™€ ë…¸ëŠë¼ ìˆ™ì œí•˜ëŠ” ê±¸ ( &nbsp;&nbsp;&nbsp;&nbsp; ) ë§ì•˜ë‹¤.</div></div>
            <div class="answer-row"><button class="answer-btn" onclick="selectAnswer(this, 1)">ìƒê³ </button><button class="answer-btn" onclick="selectAnswer(this, 1)">ìŠê³ </button><button class="answer-btn" onclick="selectAnswer(this, 1)">ì…ê³ </button></div>
        </div>
        <div class="question-step" id="q2">
            <div class="split-layout">
               <div class="passage-area">
            <div class="passage-content" style="line-height: 1.8; font-size: 16px; word-break: keep-all; text-align: justify; color: #333;">
                <strong style="display:block; font-size: 18px; margin-bottom: 20px; color: #000;">
                    ì œëª©: ìì—°ì˜ ì²­ì†Œë¶€, íŒŒë¦¬ì˜ í•œì‚´ì´
                </strong>
                <p style="margin-bottom: 15px;">
                    &nbsp;&nbsp;íŒŒë¦¬ëŠ” ì™œ ìŒì‹ë¬¼ì´ë‚˜ ì“°ë ˆê¸°í†µ ê·¼ì²˜ì— ìì£¼ ëª¨ì¼ê¹Œìš”? ì´ê²ƒì€ íŒŒë¦¬ì˜ í•œì‚´ì´ ê³¼ì •ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. íŒŒë¦¬ëŠ” ë‚˜ë¹„ë‚˜ ë²Œì²˜ëŸ¼ ê³¤ì¶©ì— ì†í•˜ëŠ” ì‘ì€ ë™ë¬¼ì…ë‹ˆë‹¤. íŒŒë¦¬ëŠ” <strong>ì•Œ &rarr; ì• ë²Œë ˆ &rarr; ë²ˆë°ê¸° &rarr; ì–´ë¥¸ë²Œë ˆ</strong>ì˜ ë„¤ ë‹¨ê³„ë¥¼ ê±°ì¹˜ëŠ” í•œì‚´ì´ ê³¼ì •ì„ ê²ªëŠ”ë°, ì´ ê³¼ì •ì„ â€˜ì™„ì „ íƒˆë°”ê¿ˆâ€™ì´ë¼ê³  í•©ë‹ˆë‹¤.
                </p>
                <p style="margin-bottom: 15px;">
                    &nbsp;&nbsp;íŒŒë¦¬ì˜ í•œì‚´ì´ëŠ” ì©ì€ ìŒì‹ë¬¼ì´ë‚˜ ë™ë¬¼ì˜ ë°°ì„¤ë¬¼ì— ì•Œì„ ë‚³ìœ¼ë©° ì‹œì‘ë©ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ íŒŒë¦¬ê°€ ìŒì‹ë¬¼ì´ë‚˜ ì“°ë ˆê¸°í†µ ê·¼ì²˜ì—ì„œ ìì£¼ ë³´ì´ëŠ” ì´ìœ ì…ë‹ˆë‹¤. ì•Œì´ ë¶€í™”í•˜ë©´ â€˜êµ¬ë”ê¸°â€™ë¼ê³  ë¶ˆë¦¬ëŠ” ì• ë²Œë ˆê°€ ë˜ëŠ”ë°, êµ¬ë”ê¸°ëŠ” ìì‹ ì´ íƒœì–´ë‚œ ê³³ ì£¼ë³€ì˜ ì©ì€ ë¬¼ì§ˆì„ ë¨¹ìœ¼ë©° ìëë‹ˆë‹¤. ì´ ê³¼ì •ì€ ì£¼ë³€ì˜ ë”ëŸ¬ìš´ ì°Œêº¼ê¸°ë¥¼ ì¤„ì´ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. êµ¬ë”ê¸°ëŠ” í—ˆë¬¼ì„ ë²—ìœ¼ë©° ëª¸ì§‘ì´ ì»¤ì§€ê³ , ëª¸ì§‘ì´ ì¶©ë¶„íˆ ì»¤ì§€ë©´ ì›€ì§ì„ì„ ë©ˆì¶”ê³  ë²ˆë°ê¸°ê°€ ë©ë‹ˆë‹¤. ë²ˆë°ê¸° ì†ì—ì„œ ì• ë²Œë ˆì˜ ëª¸ì´ ì–´ë¥¸ë²Œë ˆì˜ ëª¨ìŠµìœ¼ë¡œ ë°”ë€Œë©°, ì„±ì¥ì´ ëë‚˜ë©´ ìš°ë¦¬ê°€ ì•„ëŠ” íŒŒë¦¬ì˜ ëª¨ìŠµì´ ë©ë‹ˆë‹¤.
                </p>
                <p>
                    &nbsp;&nbsp;ë§ì€ ì‚¬ëŒë“¤ì´ íŒŒë¦¬ë¥¼ ê·€ì°®ê±°ë‚˜ ë”ëŸ¬ìš´ í•´ì¶©ì´ë¼ê³  ìƒê°í•˜ì§€ë§Œ, ì‚¬ì‹¤ íŒŒë¦¬ëŠ” ìë¼ëŠ” ë™ì•ˆ ì©ì€ ê²ƒì„ ë¨¹ì–´ ì—†ì• ê¸° ë•Œë¬¸ì— ìì—°ì„ ê¹¨ë—í•˜ê²Œ ë§Œë“œëŠ” ë° ë„ì›€ì„ ì£¼ëŠ” íŠ¹ë³„í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ê³¼í•™ìë“¤ì€ íŒŒë¦¬ë¥¼ <strong>â€˜ìì—°ì˜ ì²­ì†Œë¶€â€™</strong>ë¼ê³  ë¶€ë¥´ë©°, ìµœê·¼ì—ëŠ” êµ¬ë”ê¸°ë¥¼ ì´ìš©í•´ ìŒì‹ë¬¼ ì“°ë ˆê¸°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì—°êµ¬ë„ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>
        </div>
                      <div class="question-area">
                    <div class="question-title" style="font-size: 16px;"><span class="q-number-badge">2</span>ì´ ê¸€ì—ì„œ ê°€ì¥ ì¤‘ì‹¬ì´ ë˜ëŠ” ë§ì€ ë¬´ì—‡ì¸ê°€ìš”?</div>
                    <div class="choice-list"><button class="choice-btn" onclick="selectAnswer(this, 2)">íŒŒë¦¬ì˜ í•œì‚´ì´</button><button class="choice-btn" onclick="selectAnswer(this, 2)">ì• ë²Œë ˆ</button><button class="choice-btn" onclick="selectAnswer(this, 2)">ì‘ì€ ë™ë¬¼</button><button class="choice-btn" onclick="selectAnswer(this, 2)">ì²­ì†Œë¶€</button></div>
                </div>
            </div>
        </div>
        <div class="quiz-footer"><div class="progress-text" id="progress-text">1 / 2</div><div class="next-btn-area"><button class="next-arrow" onclick="nextStep()">â–¶</button></div></div>
    </div>

    <!-- ê²°ê³¼ ë¦¬í¬íŠ¸ í™”ë©´ -->
    <div id="result-screen">
        <div class="header-res">
            <h1><span>ì—˜ë¦¬í•˜ì´</span> ë¬¸í•´ë ¥ M-KLT ì§„ë‹¨ ê²€ì‚¬ ê²°ê³¼ ë¦¬í¬íŠ¸</h1>
            <div class="close-btn" onclick="location.reload()">âœ•</div>
        </div>

        <div class="info-bar">
            <div class="info-item">
                <span class="info-badge">ê²€ì‚¬ í•™ë…„</span>
                <span class="info-text" id="grade-text">ì´ˆë“± 4í•™ë…„</span>
            </div>
            <div class="info-item">
                <span class="info-badge">ê²€ì‚¬ì¼</span>
                <span class="info-text" id="date-text">2026.12.11</span>
            </div>
            <div class="info-item relative-container">
                <span class="info-badge">ì§„ë‹¨ ë ˆë²¨</span>
                <span class="info-text" id="level-text">ë¨¸íë¦¬ ğŸ’</span>
                <button class="level-guide-btn" onclick="togglePopup(event, 'level-popup')">ë ˆë²¨ ë“±ê¸‰í‘œ</button>
                <div id="level-popup" class="level-dropdown">
                    <div class="level-item">ë£¨ë‚˜ ğŸŒ•</div>
                    <div class="level-item">ë§ˆìŠ¤ ğŸ”¥</div>
                    <div class="level-item active">ë¨¸íë¦¬ ğŸ’</div>
                    <div class="level-item">ì£¼í”¼í„° ğŸŒ³</div>
                    <div class="level-item">ë¹„ë„ˆìŠ¤ ğŸ’–</div>
                    <div class="level-item">ìƒˆí„´ ğŸª</div>
                </div>
            </div>
            
            <div class="info-item relative-container">
                <span class="info-badge">KLQ ì§€ìˆ˜ <span class="q-mark-icon" onclick="togglePopup(event, 'klq-tooltip')">?</span></span>
                <span class="info-text" id="klq-text">4.8</span>
                <div id="klq-tooltip" class="klq-tooltip">
                    KLQ(Korean Literacy Quotient)ëŠ”<br>
                    â€˜ê¸€ì„ ì½ê³  ì´í•´í•˜ëŠ” í˜â€™ì„ ë‚˜íƒ€ë‚´ëŠ” ì ìˆ˜ì˜ˆìš”.
                </div>
            </div>
            <div class="info-item right-end">
                <select class="dropdown-select" id="history-select" onchange="changeReport()">
                    <option value="default" selected disabled hidden>ì´ì „ ê²°ê³¼ ë³´ê¸°</option>
                    <option value="current">2026.12.11</option>
                    <option value="prev">2025.10.04</option>
                </select>
            </div>
        </div>

        <div class="top-summary-container">
            <div class="summary-left">
                <!-- [ìˆ˜ì •] SVG ê¸°ë°˜ ë„ë„› ì°¨íŠ¸ë¡œ ë³€ê²½ -->
                <div class="donut-chart-wrap">
                    <div style="position: relative; width: 180px; height: 180px;">
                        <svg class="donut-chart-svg" viewBox="0 0 180 180">
                            <circle class="donut-bg-ring" cx="90" cy="90" r="75"></circle>
                            <circle class="donut-prog-ring" id="scoreDonut" cx="90" cy="90" r="75"></circle>
                        </svg>
                        <div class="donut-text" id="donutPercentText">0%</div>
                    </div>
                    <div class="donut-label" id="correct-text">ì´ 20ë¬¸í•­ ì¤‘ [17]ë¬¸í•­ ì •ë‹µ</div>
                </div>
                <div class="summary-text-wrap">
                    <div class="summary-title">
                        <span class="highlight-blue">[ê¹€ì—˜ë¦¬]</span>ë‹˜ì˜ ë¬¸í•´ë ¥ ìˆ˜ì¤€ì€ <span class="highlight-blue" id="summary-level">[ë¨¸íë¦¬ğŸ’]</span>,<br>
                        KLQ ì§€ìˆ˜ëŠ” <span class="highlight-blue" id="summary-klq">[4.8]</span>ë¡œ <br>
                        <span id="grade-level-text">ì´ˆë“± 4í•™ë…„ 8ê°œì›” ìˆ˜ì¤€</span>ì— í•´ë‹¹í•˜ë©°,<br>
                        ì¶”ì²œ í•™ìŠµ ì½”ìŠ¤ëŠ” <span class="highlight-blue" id="summary-course">[ì‘ìš© ì½”ìŠ¤]</span>ì…ë‹ˆë‹¤.
                    </div>
                    <div class="summary-desc" id="summary-desc">
                        <strong>ê¹€ì—˜ë¦¬</strong>ë‹˜ì˜ ì–´íœ˜ë ¥ê³¼ ë¹„íŒì  ë…í•´ë ¥ì€ ë§¤ìš° ë›°ì–´ë‚˜ìš”! <br> ì „ì²´ì ìœ¼ë¡œ ë¬¸í—¤ë ¥ ì‹¤ë ¥ì´ ê³ ë¥´ê²Œ ì¢‹ì€ í¸ì´ì§€ë§Œ, <br> ì¶”ë¡ ì  ë…í•´ë ¥ë§Œ ê°•í™”í•˜ë©´ ë” ë†’ì€ ë‹¨ê³„ë¡œ ê°ˆ ìˆ˜ ìˆì–´ìš”!
                    </div>
                </div>
            </div>
            <div class="summary-right">
                <div class="gauge-chart-container">
                    <div class="gauge-legend"><div><span class="legend-dot my"></span> ë‚˜ì˜ í’€ì´ ì‹œê°„</div><div><span class="legend-dot avg"></span> í‰ê·  í’€ì´ ì‹œê°„</div></div>
                    <div class="gauge-chart-wrap">
                        <svg class="gauge-svg" viewBox="0 0 200 105"><path class="gauge-bg-arc" d="M 20 100 A 80 80 0 0 1 180 100" /><path class="gauge-my-arc" d="M 20 100 A 80 80 0 0 1 180 100" /></svg>
                        <div class="gauge-character" id="gaugeChar"><span>ë‚˜</span></div>
                        <div class="gauge-avg-label" id="gaugeAvgLabel">36ë¶„</div>
                    </div>
                    <div class="gauge-bottom-text"><div class="gauge-sub-label">ë‚˜ì˜ í’€ì´ ì‹œê°„</div><div class="gauge-main-label"><span class="highlight-blue" id="my-time">23</span>ë¶„ / 50ë¶„</div></div>
                </div>
            </div>
        </div>

        <div class="bottom-details-grid">
            <div>
                <div class="graph-header">
                    <div class="section-title-pill">ì˜ì—­ë³„ ìˆ˜ì¤€ ê·¸ë˜í”„</div>
                    <div class="avg-legend"><span class="avg-icon-visual"></span> &lt;í•™ë…„ í‰ê· &gt;</div>
                </div>
                <div class="graph-container">
                    <div class="y-axis-grid"><div class="grid-line" style="bottom:0%"></div><div class="grid-label" style="bottom:0%">0</div><div class="grid-line" style="bottom:50%"></div><div class="grid-label" style="bottom:50%">50</div><div class="grid-line" style="bottom:100%"></div><div class="grid-label" style="bottom:100%">100</div></div>
                    
                    <svg class="svg-graph-layer" viewBox="0 0 500 200" preserveAspectRatio="none">
                        <polyline class="avg-line" points="62.5,47 187.5,120 312.5,100 437.5,40" />
                        <circle class="avg-dot" cx="62.5" cy="47" />
                        <circle class="avg-dot" cx="187.5" cy="120" />
                        <circle class="avg-dot" cx="312.5" cy="100" />
                        <circle class="avg-dot" cx="437.5" cy="40" />
                    </svg>

                    <!-- ë§‰ëŒ€ ê·¸ë˜í”„ ì˜ì—­ -->
                    <div class="bar-group"><span class="bar-value" id="score-vocab">95</span><div class="bar color-1" id="bar-vocab"></div>
                        <div class="tooltip-container">
                            <div class="bar-label">
                                <div class="label-content"><span class="label-icon c1"></span>ì–´íœ˜ë ¥</div>
                                <span class="graph-help-btn" onclick="togglePopup(event, 't1')">?</span>
                            </div>
                            <span class="tooltip-text" id="t1">ë‚±ë§ì˜ ì •í™•í•œ ëœ»ì„ ì•Œê³ , ë¬¸ë§¥ì— ë§ê²Œ ì ì ˆíˆ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥</span>
                        </div>
                    </div>
                    <div class="bar-group"><span class="bar-value" id="score-fact">82</span><div class="bar color-2" id="bar-fact"></div>
                        <div class="tooltip-container">
                            <div class="bar-label">
                                <div class="label-content"><span class="label-icon c2"></span>ì‚¬ì‹¤ì  ë…í•´ë ¥</div>
                                <span class="graph-help-btn" onclick="togglePopup(event, 't2')">?</span>
                            </div>
                            <span class="tooltip-text" id="t2">ê¸€ì— ë“œëŸ¬ë‚œ ì •ë³´ë¥¼ ìˆëŠ” ê·¸ëŒ€ë¡œ ì •í™•í•˜ê²Œ íŒŒì•…í•˜ëŠ” ëŠ¥ë ¥</span>
                        </div>
                    </div>
                    <div class="bar-group"><span class="bar-value" id="score-crit">87</span><div class="bar color-3" id="bar-crit"></div>
                        <div class="tooltip-container">
                            <div class="bar-label">
                                <div class="label-content"><span class="label-icon c3"></span>ë¹„íŒì  ë…í•´ë ¥</div>
                                <span class="graph-help-btn" onclick="togglePopup(event, 't3')">?</span>
                            </div>
                            <span class="tooltip-text" id="t3">ê¸€ì“´ì´ì˜ ì£¼ì¥ì´ë‚˜ ì˜ê²¬ì˜ íƒ€ë‹¹ì„±ì„ ë”°ì ¸ë³´ê³ , ìì‹ ì˜ ê´€ì ì—ì„œ í‰ê°€í•˜ëŠ” ëŠ¥ë ¥</span>
                        </div>
                    </div>
                    <div class="bar-group"><span class="bar-value" id="score-inf">50</span><div class="bar color-4" id="bar-inf"></div>
                        <div class="tooltip-container">
                            <div class="bar-label">
                                <div class="label-content"><span class="label-icon c4"></span>ì¶”ë¡ ì  ë…í•´ë ¥</div>
                                <span class="graph-help-btn" onclick="togglePopup(event, 't4')">?</span>
                            </div>
                            <span class="tooltip-text" id="t4">ê¸€ì— ì§ì ‘ ë“œëŸ¬ë‚˜ì§€ ì•Šì€ ë‚´ìš©ì„ ë‹¨ì„œë¥¼ í†µí•´ ë¯¸ë£¨ì–´ ì§ì‘í•˜ëŠ” ëŠ¥ë ¥</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="insight-container">
                <div class="section-title-pill">ë¶„ì„ ê²°ê³¼</div>
                <div class="insight-wrapper">
                    <div class="insight-box">
                        <div class="insight-label">ê°€ì¥ ì˜í•˜ëŠ” ì˜ì—­</div>
                        <div class="insight-value" id="insight-best" style="color:var(--col-vocab)">â­ ì–´íœ˜ë ¥</div>
                    </div>
                    <div class="insight-box">
                        <div class="insight-label">ê°€ì¥ ëª»í•˜ëŠ” ì˜ì—­</div>
                        <div class="insight-value" id="insight-worst" style="color:var(--col-inf)">âš  ì¶”ë¡ ì  ë…í•´ë ¥</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-title-pill">ì˜ì—­ë³„ í•™ìŠµ ê°€ì´ë“œ</div>
        <div class="guide-grid">
            <div class="guide-card c1"><div class="guide-header" id="header-vocab">ì–´íœ˜ë ¥</div><div class="guide-body" id="guide-vocab"></div></div>
            <div class="guide-card c2"><div class="guide-header" id="header-fact">ì‚¬ì‹¤ì  ë…í•´ë ¥</div><div class="guide-body" id="guide-fact"></div></div>
            <div class="guide-card c3"><div class="guide-header" id="header-crit">ë¹„íŒì  ë…í•´ë ¥</div><div class="guide-body" id="guide-crit"></div></div>
            <div class="guide-card c4"><div class="guide-header" id="header-inf">ì¶”ë¡ ì  ë…í•´ë ¥</div><div class="guide-body" id="guide-inf"></div></div>
        </div>

        <div class="section-title-pill">ìˆ˜ì¤€ë³„ ì¶”ì²œ ì½˜í…ì¸ </div>
        <div class="rec-container">
            <div class="rec-group"><div class="rec-title">ë¬¸í•´ë ¥ í”„ë¡œê·¸ë¨</div>
                <div class="program-box advanced" id="rec-prog-box">
                    <span class="program-badge" id="rec-prog-badge">&lt;ì‘ìš© ì½”ìŠ¤&gt;</span>
                    <div class="program-name" id="rec-prog-name">ğŸš€ ë¬¸í•´ë ¥ ì—…ê·¸ë ˆì´ë“œ</div>
                    <div style="font-size:13px; color:#666; margin-top:10px;" id="rec-prog-desc">ë‹¤ì–‘í•œ ì§€ë¬¸ ì½ê¸° í›ˆë ¨</div>
                </div>
            </div>
            <div class="plus-icon">+</div>
            <div class="rec-group"><div class="rec-title">í•™êµê³µë¶€ í”ŒëŸ¬ìŠ¤</div>
                <div class="book-list" id="rec-book-list"></div>
            </div>
            <div class="plus-icon">+</div>
            <div class="rec-group"><div class="rec-title">ë¹„êµê³¼ ì½˜í…ì¸ </div><div class="btn-list"><button class="rec-btn">ì—˜ë¦¬í•˜ì´ ë¶í´ëŸ½</button><button class="rec-btn black">ê¸€ë¡œë²Œ ë¦¬ë”ì‹­</button><button class="rec-btn black">ìˆ˜í–‰í‰ê°€+</button></div></div>
        </div>
    </div>
</div>

<script>
    /* =========================================
       1. ìµœì í™”ëœ ë°ì´í„° ë° ì „ì—­ ë³€ìˆ˜
       ========================================= */
    let currentStep = 1; 
    const totalSteps = 2;
    let audioCtx = null; // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ëŠ” ì²« ì¸í„°ë™ì…˜ ì‹œ ì´ˆê¸°í™” (Lazy Init)

    // ë¦¬í¬íŠ¸ ë°ì´í„° (JSON í˜•íƒœ ìœ ì§€)
    const reportData = {
        current: {
            date: '2026.12.11', grade: 'ì´ˆë“± 4í•™ë…„', level: 'ë¨¸íë¦¬ ğŸ’', klq: '4.8',
            correct: 17, time: 23, scores: [95, 82, 87, 50], avgScores: [50, 65, 45, 40],
            summaryLevel: '[ë¨¸íë¦¬ğŸ’]', summaryKlq: '[4.8]', summaryCourse: '[ì‘ìš© ì½”ìŠ¤]',
            gradeLevel: "ì´ˆë“± 4í•™ë…„ 8ê°œì›” ìˆ˜ì¤€",
            desc: "<strong>ê¹€ì—˜ë¦¬</strong>ë‹˜ì€ ì–´íœ˜ë ¥ê³¼ ì‚¬ì‹¤ì  ë¹„íŒë ¥ì´ ì•„ì£¼ ë›°ì–´ë‚˜ìš”. <br> ì „ë°˜ì ìœ¼ë¡œ ë¬¸í•´ë ¥ ì‹¤ë ¥ì´ ê³ ë¥´ê²Œ ì¢‹ì€ í¸ì´ì—ìš”. <br> ì´ì œ ì¶”ë¡ ì  ë…í•´ë ¥ë§Œ ê°•í™”í•˜ë©´ ë” ë†’ì€ ë‹¨ê³„ë¡œ ê°ˆ ìˆ˜ ìˆì–´ìš”.",
            bestArea: { text: "â­ ì–´íœ˜ë ¥", color: "var(--col-vocab)" },
            worstArea: { text: "âš  ì¶”ë¡ ì  ë…í•´ë ¥", color: "var(--col-inf)" },
            guideLevels: { vocab: "(ë§¤ìš° ìš°ìˆ˜)", fact: "(ìš°ìˆ˜)", crit: "(ìš°ìˆ˜)", inf: "(ë³´ì™„ í•„ìš”)" },
            guides: {
                vocab: "êµê³¼ì„œì™€ ì¼ìƒì—ì„œ ì“°ëŠ” ì–´íœ˜ë¥¼ ì•„ì£¼ ì •í™•í•˜ê²Œ ì´í•´í•˜ê³  ìˆì–´ìš”. ì´ì œëŠ” ìœ ì˜ì–´, ë°˜ì˜ì–´, ë‹¤ì˜ì–´ì²˜ëŸ¼ ë‹¨ì–´ë“¤ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ì‚´í´ë³´ë©° ì–´íœ˜ë§ì„ ë„“í˜€ ë³´ì„¸ìš”. í•œìì–´ì˜ ì†ëœ»ì„ ìµíˆê±°ë‚˜ ê´€ìš© í‘œí˜„ì„ í•¨ê»˜ ê³µë¶€í•˜ë©´ ì–´íœ˜ê°€ ë” í’ë¶€í•´ì ¸ìš”. ë…ì„œí•  ë•Œ ëª¨ë¥´ëŠ” ë‹¨ì–´ê°€ ë‚˜ì˜¤ë©´ ë¬¸ë§¥ìœ¼ë¡œ ì§ì‘í•´ ë³¸ ë’¤ ì‚¬ì „ìœ¼ë¡œ í™•ì¸í•˜ëŠ” ìŠµê´€ì„ ê³„ì† ìœ ì§€í•´ ë³´ì„¸ìš”.",
                fact: "ê¸€ì˜ í•µì‹¬ ë‚´ìš©ê³¼ ì„¸ë¶€ ì •ë³´ë¥¼ ë§¤ìš° ì •í™•í•˜ê²Œ íŒŒì•…í•˜ê³  ìˆì–´ìš”. ë¬¸ë‹¨ë³„ ì¤‘ì‹¬ ë¬¸ì¥ì„ ì°¾ê±°ë‚˜ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë¬¶ì–´ ì •ë¦¬í•˜ëŠ” ì—°ìŠµì„ ì´ì–´ê°€ë©´ ë” íƒ„íƒ„í•œ ë…í•´ë ¥ì´ ìƒê²¨ìš”. ê¸€ì˜ êµ¬ì¡°ë¥¼ ì‚´í”¼ë©° â€˜ë¬´ì—‡ì´ ë¨¼ì €, ë‹¤ìŒì€ ë¬´ì—‡ì¸ì§€â€™ë¥¼ ìƒê°í•´ ì½ìœ¼ë©´ ë³µì¡í•œ ë‚´ìš©ë„ ë¹ ë¥´ê²Œ ì´í•´í•˜ëŠ” í˜ì´ ê¸¸ëŸ¬ì ¸ìš”.",
                crit: "ê¸€ì“´ì´ì˜ ì£¼ì¥ê³¼ ê·¼ê±°ë¥¼ íŒë‹¨í•˜ëŠ” ëŠ¥ë ¥ì´ ë§¤ìš° ë›°ì–´ë‚˜ìš”. ë‹¤ì–‘í•œ ê´€ì ì˜ ê¸€ì„ ì½ìœ¼ë©° ë¹„íŒì ìœ¼ë¡œ ìƒê°í•˜ëŠ” ì—°ìŠµì„ ë” ê¹Šê²Œ í•´ ë³´ì„¸ìš”. ê¸€ì“´ì´ì˜ ì˜ë„, ê·¼ê±°ì˜ ì ì ˆì„± ë“±ì„ ë”°ì ¸ë³´ê³  ìì‹ ì˜ ì˜ê²¬ê³¼ ë¹„êµí•´ ë³´ëŠ” í™œë™ì´ ë„ì›€ì´ ë¼ìš”. ì‚¬ì„¤ì´ë‚˜ ì¹¼ëŸ¼ì„ ì½ê³  ì°¬ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ì–´ í† ë¡ í•´ ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì´ì—ìš”.",
                inf: "ê¸€ ì† ë‹¨ì„œë¥¼ ëª¨ì•„ ìˆ¨ê²¨ì§„ ì •ë³´ë¥¼ ì§ì‘í•˜ëŠ” ëŠ¥ë ¥ì„ ë” í‚¤ìš°ë©´ ì¢‹ì•„ìš”. ë¬¸ë§¥ì„ í†µí•´ ì¸ë¬¼ì˜ ê°ì • ë³€í™”ë‚˜ ì‚¬ê±´ì˜ íë¦„ì„ ì¶”ë¡ í•˜ëŠ” ì—°ìŠµì„ ì§‘ì¤‘ì ìœ¼ë¡œ í•´ ë³´ì„¸ìš”. â€˜ì™œ ì´ë ‡ê²Œ í–ˆì„ê¹Œ?â€™, â€˜ë‹¤ìŒì—ëŠ” ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚ ê¹Œ?â€™ ê°™ì€ ì§ˆë¬¸ì„ ìŠ¤ìŠ¤ë¡œ ë˜ì§€ë©° ì½ìœ¼ë©´ ì¶”ë¡  ëŠ¥ë ¥ì´ í¬ê²Œ ìë¼ìš”."
            },
            recommendation: { type: 'advanced', badge: '<ì‘ìš© ì½”ìŠ¤>', title: 'ğŸš€ ë¬¸í•´ë ¥ ì—…ê·¸ë ˆì´ë“œ', desc: 'êµ¬ì¡° ë¬¸í•´ ê³µì‹ìœ¼ë¡œ ì§€ë¬¸ ì½ê¸°' },
            books: [
                { title: "ë¬¸í•´ë ¥ì„<br>ë¶€íƒí•´ 3", subTitle: "ë¬¸í•´ë ¥ì„ ë¶€íƒí•´<br>3í¸", emoji: "ğŸ“˜", color: "book-color-1" },
                { title: "ë¿Œë¦¬ê¹Šì€<br>ë…í•´ë ¥ 3", subTitle: "ë¿Œë¦¬ê¹Šì€ ì´ˆë“±êµ­ì–´<br>ë…í•´ë ¥ 3ë‹¨ê³„", emoji: "ğŸŒ³", color: "book-color-2" }
            ]
        },
        prev: {
            date: '2025.10.04', grade: 'ì´ˆë“± 3í•™ë…„', level: 'ë§ˆìŠ¤ ğŸ”¥', klq: '2.5',
            correct: 12, time: 35, scores: [40, 90, 60, 50], avgScores: [60, 55, 45, 48],
            summaryLevel: '[ë§ˆìŠ¤ ğŸ”¥]', summaryKlq: '[2.5]', summaryCourse: '[ê¸°ë³¸ ì½”ìŠ¤]',
            gradeLevel: "ì´ˆë“± 2í•™ë…„ 5ê°œì›” ìˆ˜ì¤€",
            desc: "<strong>ê¹€ì—˜ë¦¬</strong>ë‹˜ì€ ì‚¬ì‹¤ì  ë…í•´ë ¥ì´ ëˆˆì— ë„ê²Œ ê°•í•œ í¸ì´ì—ìš”. <br> ì´ì œ ì–´íœ˜ë ¥ë§Œ ì¡°ê¸ˆ ë³´ì™„í•˜ë©´ ë…í•´ ì‹¤ë ¥ì´ í›¨ì”¬ ì¢‹ì•„ì§ˆ ê±°ì˜ˆìš”. <br> ë¹„íŒì Â·ì¶”ë¡ ì  ë…í•´ë ¥ë„ ê³„ì† ê¾¸ì¤€íˆ í‚¤ì›Œ ë³´ì„¸ìš”.",
            bestArea: { text: "â­ ì‚¬ì‹¤ì  ë…í•´ë ¥", color: "var(--col-fact)" },
            worstArea: { text: "âš  ì–´íœ˜ë ¥", color: "var(--col-vocab)" },
            guideLevels: { vocab: "(ë³´ì™„ í•„ìš”)", fact: "(ë§¤ìš° ìš°ìˆ˜)", crit: "(ë³´í†µ)", inf: "(ë³´ì™„ í•„ìš”)" },
            guides: {
                vocab: "ê¸°ì´ˆ ì–´íœ˜ë ¥ì„ ìš°ì„ ì ìœ¼ë¡œ ë‹¤ì ¸ì•¼ í•´ìš”. êµê³¼ì„œì— ë‚˜ì˜¤ëŠ” ê¸°ë³¸ ë‹¨ì–´ë¶€í„° ì°¨ê·¼ì°¨ê·¼ ìµíˆëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”. ë‚±ë§ ì¹´ë“œë‚˜ ê·¸ë¦¼ ë‹¨ì–´ í•™ìŠµì„ í™œìš©í•´ ë³´ì„¸ìš”. í•˜ë£¨ì— 3ê°œ ì •ë„ ìƒˆë¡œìš´ ë‹¨ì–´ë¥¼ ìµíˆê³  ê°„ë‹¨í•œ ë¬¸ì¥ì„ ë§Œë“¤ì–´ ë³´ëŠ” ì—°ìŠµì„ ê¾¸ì¤€íˆ í•˜ë©´ í° ë„ì›€ì´ ë¼ìš”. íƒ„íƒ„í•œ ì–´íœ˜ë ¥ì´ ìˆì–´ì•¼ ê¸€ ë‚´ìš©ì„ ì •í™•íˆ ì´í•´í•  ìˆ˜ ìˆì–´ìš”.",
                fact: "ê¸€ì—ì„œ ì¤‘ìš”í•œ ë‚´ìš©ì„ ì°¾ê³  ì •ë¦¬í•˜ëŠ” ì—°ìŠµì´ ë” í•„ìš”í•´ìš”. ë¬¸ë‹¨ì„ ì½ì€ ë’¤ â€˜ì´ ë¬¸ë‹¨ì€ ë¬´ìŠ¨ ì´ì•¼ê¸°ì˜€ì§€?â€™ í•˜ê³  í•œ ë¬¸ì¥ìœ¼ë¡œ ë§í•´ë³´ëŠ” ì—°ìŠµì„ í•´ë³´ì„¸ìš”. ê¸€ ì† ì •ë³´ê°€ ì–¸ì œÂ·ëˆ„ê°€Â·ë¬´ì—‡ì„Â·ì™œÂ·ì–´ë–»ê²Œ ì¼ì–´ë‚¬ëŠ”ì§€(ìœ¡í•˜ì›ì¹™)ë¥¼ í™•ì¸í•˜ë©° ì½ìœ¼ë©´ ì „ì²´ ë‚´ìš©ì„ í›¨ì”¬ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì–´ìš”.",
                crit: "ì‚¬ì‹¤ê³¼ ì˜ê²¬ì„ êµ¬ë¶„í•˜ëŠ” ëŠ¥ë ¥ì´ ì•„ì§ ë¶€ì¡±í•´ì„œ ê´€ë ¨ ì—°ìŠµì´ í•„ìš”í•´ìš”. ê¸€ì“´ì´ì˜ ì£¼ì¥ê³¼ ê·¸ ê·¼ê±°ê°€ íƒ€ë‹¹í•œì§€ ìƒê°í•´ ë³´ë©° ì½ì–´ ë³´ì„¸ìš”. â€˜ì´ ë§ì´ ì •ë§ ë§ì„ê¹Œ?â€™ í•˜ê³  ìŠ¤ìŠ¤ë¡œ ì§ˆë¬¸í•˜ë©° ì½ëŠ” íƒœë„ê°€ ì¤‘ìš”í•´ìš”. ê´‘ê³ ë¬¸ì´ë‚˜ ì•ˆë‚´ë¬¸ì„ ì½ìœ¼ë©° ì„¤ë“í•˜ëŠ” ë¬¸ì¥ê³¼ ì •ë³´ ì œê³µ ë¬¸ì¥ì„ ë¹„êµí•´ ë³´ëŠ” í™œë™ë„ ì¢‹ì•„ìš”.",
                inf: "ìˆ¨ê²¨ì§„ ì˜ë¯¸ë¥¼ íŒŒì•…í•˜ëŠ” ë° ì–´ë ¤ì›€ì„ ëŠë‚„ ìˆ˜ ìˆì–´ìš”. ê¸€ì ê·¸ëŒ€ë¡œì˜ ì •ë³´ë¿ ì•„ë‹ˆë¼ ìƒí™©ê³¼ ë¬¸ë§¥ì„ í†µí•´ ë‚´ìš©ì„ ì¶”ì¸¡í•˜ëŠ” ì—°ìŠµì´ í•„ìš”í•´ìš”. ì´ì•¼ê¸°ì±…ì„ ì½ìœ¼ë©° ë“±ì¥ì¸ë¬¼ì˜ í‘œì •ì´ë‚˜ í–‰ë™ì„ ë³´ê³  ê¸°ë¶„ì„ ì§ì‘í•´ ë³´ì„¸ìš”. ë’·ì´ì•¼ê¸°ë¥¼ ìƒìƒí•´ì„œ ì¨ë³´ëŠ” í™œë™ë„ ì¶”ë¡  ëŠ¥ë ¥ì„ í‚¤ìš°ëŠ” ë° íš¨ê³¼ì ì´ì—ìš”."
            },
            recommendation: { type: 'basic', badge: '<ê¸°ë³¸ ì½”ìŠ¤>', title: 'ğŸŒ± ë¬¸í•´ë ¥ ê¸°ë³¸ ì™„ì„±', desc: 'ë…í•´ì˜ í•µì‹¬ ì „ëµ ìµíˆê¸°' },
            books: [
                { title: "ë¬¸í•´ë ¥ì„<br>ë¶€íƒí•´ 2", subTitle: "ë¬¸í•´ë ¥ì„ ë¶€íƒí•´<br>2í¸", emoji: "ğŸ“™", color: "book-color-3" },
                { title: "ë¹ ì‘<br>ë¹„ë¬¸í•™ 1", subTitle: "ë¹ ì‘ ì´ˆë“± êµ­ì–´<br>ë¹„ë¬¸í•™ ë…í•´ 1ë‹¨ê³„", emoji: "âš¡", color: "book-color-4" }
            ]
        }
    };

    /* =========================================
       2. ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ (ìµœì í™”: Lazy Init)
       ========================================= */
    function initAudio() {
        if (!audioCtx) {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            audioCtx = new AudioContext();
        }
        if (audioCtx.state === 'suspended') audioCtx.resume();
    }

    function playTone(type) {
        initAudio(); // ì‹¤í–‰ ì „ ì²´í¬
        const now = audioCtx.currentTime;
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.type = 'sine';
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'tick') {
            osc.frequency.setValueAtTime(800, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
            gainNode.gain.setValueAtTime(0.7, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start();
            osc.stop(now + 0.1);
        } else if (type === 'result') {
            const notes = [523.25, 659.25, 783.99, 1046.50];
            notes.forEach((freq, i) => {
                const o = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                o.type = 'sine';
                o.frequency.value = freq;
                g.gain.setValueAtTime(0, now + i*0.1);
                g.gain.linearRampToValueAtTime(0.2, now + i*0.1 + 0.05);
                g.gain.exponentialRampToValueAtTime(0.01, now + i*0.1 + 0.4);
                o.connect(g);
                g.connect(audioCtx.destination);
                o.start(now + i*0.1);
                o.stop(now + i*0.1 + 0.4);
            });
        }
    }

    /* =========================================
       3. í€´ì¦ˆ ë¡œì§
       ========================================= */
    function startDiagnosticTest() { 
        initAudio();
        document.getElementById('main-screen').style.display = 'none'; 
        document.getElementById('quiz-screen').style.display = 'flex'; 
    }
    
    function selectAnswer(btn, step) { 
        let container = step === 1 ? document.querySelector('#q1 .answer-row') : document.querySelector('#q2 .choice-list'); 
        container.querySelectorAll('button').forEach(b => b.classList.remove('selected')); 
        btn.classList.add('selected'); 
    }
    
    function nextStep() { 
        const currentQuestion = document.getElementById(`q${currentStep}`);
        const isSelected = currentQuestion.querySelector('.selected');
        if (!isSelected) { alert("ì •ë‹µì„ ì„ íƒí•´ì•¼ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”!"); return; }
        
        if (currentStep < totalSteps) { 
            document.getElementById(`q${currentStep}`).classList.remove('active'); 
            if(currentStep === 1) document.getElementById('badge-vocab').classList.remove('active');
            currentStep++; 
            document.getElementById(`q${currentStep}`).classList.add('active'); 
            if(currentStep === 2) document.getElementById('badge-reading').classList.add('active');
            document.getElementById('progress-text').textContent = `${currentStep} / ${totalSteps}`; 
        } else { 
            document.getElementById('quiz-screen').style.display = 'none'; 
            document.getElementById('loading-screen').style.display = 'flex';
            
            // ë¡œë”© íš¨ê³¼ (setInterval ì‚¬ìš©)
            let tickCount = 0;
            const loadingInterval = setInterval(() => {
                playTone('tick');
                tickCount++;
                if(tickCount >= 3) clearInterval(loadingInterval);
            }, 800);

            // [ìˆ˜ì •] 2500ms -> 3200msë¡œ ê°„ê²© ëŠ˜ë¦¼
            setTimeout(() => { 
                document.getElementById('loading-screen').style.display = 'none'; 
                showResult(); 
            }, 3200); 
        } 
    }
    
    function showResult() { 
        playTone('result'); 
        document.getElementById('result-screen').style.display = 'block'; 
        loadReportData('current');
    }

    function changeReport() {
        const select = document.getElementById('history-select');
        loadReportData(select.value === 'prev' ? 'prev' : 'current');
    }

    /* =========================================
       4. ë¦¬í¬íŠ¸ ë Œë”ë§ ë° ì• ë‹ˆë©”ì´ì…˜ (ìµœì í™”)
       ========================================= */
    function loadReportData(key) {
        const data = reportData[key];
        
        // í…ìŠ¤íŠ¸ ë°ì´í„° ë°”ì¸ë”© (DOM ìºì‹± ì—†ì´ ì§ê´€ì„±ì„ ìœ„í•´ ì§ì ‘ í˜¸ì¶œ)
        const setText = (id, text) => document.getElementById(id).innerText = text;
        const setHTML = (id, html) => document.getElementById(id).innerHTML = html;

        setText('grade-text', data.grade);
        setText('date-text', data.date);
        setText('level-text', data.level);
        setText('klq-text', data.klq);
        setText('correct-text', `ì´ 20ë¬¸í•­ ì¤‘ [${data.correct}]ë¬¸í•­ ì •ë‹µ`);
        setText('summary-level', data.summaryLevel);
        setText('summary-klq', data.summaryKlq);
        setText('summary-course', data.summaryCourse);
        setText('grade-level-text', data.gradeLevel);
        setText('my-time', data.time);
        setHTML('summary-desc', data.desc);

        // ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        const bestBox = document.getElementById('insight-best');
        bestBox.innerText = data.bestArea.text;
        bestBox.style.color = data.bestArea.color;
        const worstBox = document.getElementById('insight-worst');
        worstBox.innerText = data.worstArea.text;
        worstBox.style.color = data.worstArea.color;

        // ë ˆë²¨ ì•¡í‹°ë¸Œ ì²˜ë¦¬
        document.querySelectorAll('#level-popup .level-item').forEach(item => {
            item.classList.toggle('active', item.innerText.replace(/\s/g, '') === data.level.replace(/\s/g, ''));
        });

        // ê°€ì´ë“œ ì—…ë°ì´íŠ¸
        setHTML('header-vocab', `ì–´íœ˜ë ¥ <span class="level-tag">${data.guideLevels.vocab}</span>`);
        setHTML('header-fact', `ì‚¬ì‹¤ì  ë…í•´ë ¥ <span class="level-tag">${data.guideLevels.fact}</span>`);
        setHTML('header-crit', `ë¹„íŒì  ë…í•´ë ¥ <span class="level-tag">${data.guideLevels.crit}</span>`);
        setHTML('header-inf', `ì¶”ë¡ ì  ë…í•´ë ¥ <span class="level-tag">${data.guideLevels.inf}</span>`);
        setText('guide-vocab', data.guides.vocab);
        setText('guide-fact', data.guides.fact);
        setText('guide-crit', data.guides.crit);
        setText('guide-inf', data.guides.inf);

        // ì¶”ì²œ ì½”ìŠ¤ ì—…ë°ì´íŠ¸
        const recBox = document.getElementById('rec-prog-box');
        setText('rec-prog-badge', data.recommendation.badge);
        setText('rec-prog-name', data.recommendation.title);
        setHTML('rec-prog-desc', data.recommendation.desc);
        recBox.className = `program-box ${data.recommendation.type}`; // í´ë˜ìŠ¤ ì´ˆê¸°í™” í›„ ì¶”ê°€

        // ì±… ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        const bookList = document.getElementById('rec-book-list');
        bookList.innerHTML = data.books.map(book => `
            <div class="book-item">
                <div class="book-cover ${book.color}">
                    <div><span class="book-emoji">${book.emoji}</span><div class="book-title-on-cover">${book.title}</div></div>
                </div>
                <div class="book-title">${book.subTitle}</div>
            </div>
        `).join('');

        // [ìˆ˜ì •] ê·¸ë˜í”„ ì• ë‹ˆë©”ì´ì…˜ ë¡œì§ ê°œì„ 
        const barIds = ['bar-vocab', 'bar-fact', 'bar-crit', 'bar-inf'];
        const scoreIds = ['score-vocab', 'score-fact', 'score-crit', 'score-inf'];
        
        // 1. ì´ˆê¸°í™” (ë†’ì´ 0)
        data.scores.forEach((score, i) => {
            document.getElementById(scoreIds[i]).innerText = score;
            const bar = document.getElementById(barIds[i]);
            bar.style.height = '0px';
            bar.parentElement.classList.remove('animate');
        });

        // 2. ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰ (ì§€ì—° ì ìš©ìœ¼ë¡œ ì”¹í˜ ë°©ì§€)
        setTimeout(() => {
            data.scores.forEach((score, i) => {
                const bar = document.getElementById(barIds[i]);
                bar.style.height = (score * 1.8) + 'px';
                bar.parentElement.classList.add('animate');
            });
        }, 100);

        updateAvgGraph(data.avgScores);

        // [ìˆ˜ì •] ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„ì„ 1000ms, 1500msì—ì„œ 600ms, 800msë¡œ ëŒ€í­ ë‹¨ì¶•
        animateValue('scoreDonut', 0, Math.floor((data.correct / 20) * 100), 600, 'donut');
        animateValue('gaugeChar', 0, data.time, 800, 'gauge', (key === 'prev' ? 30 : 36));
    }

    function updateAvgGraph(avgScores) {
        const xCoords = [62.5, 187.5, 312.5, 437.5];
        let pointsString = "";
        const dots = document.querySelectorAll('.svg-graph-layer .avg-dot');
        
        avgScores.forEach((score, i) => {
            const x = xCoords[i];
            const y = 200 - (score * 1.8);
            pointsString += `${x},${y} `;
            if(dots[i]) { dots[i].setAttribute('cx', x); dots[i].setAttribute('cy', y); }
        });
        document.querySelector('.avg-line').setAttribute('points', pointsString.trim());
    }

    // í†µí•© ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜ (requestAnimationFrame ì‚¬ìš©)
    function animateValue(targetId, start, end, duration, type, avgTime = 0) {
        let startTimestamp = null;
        const element = document.getElementById(targetId);

        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            const currentVal = Math.floor(progress * (end - start) + start);

            if (type === 'donut') {
                // [ìˆ˜ì •] SVG ë„ë„› ì°¨íŠ¸ ì• ë‹ˆë©”ì´ì…˜ ë¡œì§
                const percent = currentVal;
                const circumference = 2 * Math.PI * 75; // ë°˜ì§€ë¦„ 75
                const offset = circumference * (1 - percent / 100);
                element.style.strokeDashoffset = offset;
                document.getElementById('donutPercentText').textContent = `${percent}%`;

            } else if (type === 'gauge') {
                // ê²Œì´ì§€ ì• ë‹ˆë©”ì´ì…˜ ë¡œì§
                const totalTime = 50;
                const myPercent = currentVal / totalTime;
                const avgPercent = avgTime / totalTime;
                
                // ë‚´ ì ìˆ˜ Arc
                const pathLength = 251.3;
                document.querySelector('.gauge-my-arc').style.strokeDashoffset = pathLength * (1 - myPercent);
                
                // ë‚´ ìºë¦­í„° ìœ„ì¹˜
                const radius = 80; const centerX = 100; const centerY = 100;
                const myAngleRad = Math.PI * (1 - myPercent);
                const charX = centerX + radius * Math.cos(myAngleRad);
                const charY = centerY - radius * Math.sin(myAngleRad);
                element.style.left = `${(charX / 200) * 100}%`;
                element.style.top = `${(charY / 105) * 100}%`;

                // í‰ê·  ë¼ë²¨ ìœ„ì¹˜
                const avgLabel = document.getElementById('gaugeAvgLabel');
                const avgAngleRad = Math.PI * (1 - avgPercent);
                const avgX = centerX + radius * Math.cos(avgAngleRad);
                const avgY = centerY - radius * Math.sin(avgAngleRad);
                avgLabel.style.left = `${(avgX / 200) * 100}%`;
                avgLabel.style.top = `${((avgY - 15) / 105) * 100}%`;
                avgLabel.textContent = `${avgTime}ë¶„`;
            }

            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    }

    /* =========================================
       5. íŒì—… ë° ìœ í‹¸ë¦¬í‹° (í†µí•©)
       ========================================= */
    function closeAllPopups() {
        document.querySelectorAll('.klq-tooltip, .level-dropdown, .tooltip-text').forEach(el => el.classList.remove('show'));
    }

    // [ìµœì í™”] ëª¨ë“  íŒì—… í† ê¸€ ë¡œì§ì„ í•˜ë‚˜ë¡œ í†µí•©
    function togglePopup(event, targetId) {
        event.stopPropagation();
        const target = document.getElementById(targetId);
        if (!target) return;
        
        const isShown = target.classList.contains('show');
        closeAllPopups(); // ë‹¤ë¥¸ ê±° ë‹¤ ë‹«ê³ 
        if (!isShown) target.classList.add('show'); // íƒ€ê²Ÿë§Œ ì—´ê¸°
    }

    // í™”ë©´ í´ë¦­ ì‹œ íŒì—… ë‹«ê¸°
    document.addEventListener('click', closeAllPopups);
</script>

</body>
</html>
